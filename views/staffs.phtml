<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><?php echo Clients::$setting['siteName'] ? Clients::$setting['siteName'] : 'Staffs';?></title>
    <link rel="stylesheet" href="/views/assets/dataTables/boxicons.min.css">
    <link rel="stylesheet" href="/views/assets/dataTables/responsive.dataTables.min.css">
    <link rel="stylesheet" href="/views/assets/dataTables/dataTables.bootstrap4.min.css">
    <link rel="stylesheet" href="/views/assets/dataTables/bootstrap.min.css">
    <link rel="stylesheet" href="/views/assets/css/students.css">
    <link rel="stylesheet" href="/views/assets/css/upload.css">
    <link rel="stylesheet" href="/views/assets/css/nav.css">
    <link rel="stylesheet" href="/views/assets/css/alert.css">

 
</head>
<body>
  <div class="alert-box red" data-student="error"></div>
  <?php include_once $_SERVER['DOCUMENT_ROOT'].'/views/components/navbar.php'; ?>
<div class="container">
<br><a href="/add-staff" style="color:white;" class="btn btn-success">Add staff</a>

  <div class="row py-5">
    <div class="col-12">

<div class="parentContainer">
  <div class="controlContainer">
    <div class="inputFileHolder">
      <button class="btn btn-flat pull-right" onclick="uploadCsv();" title="Upload file">
      <svg id="Layer_1" width="17px" height="17px" fill="#FFFFFF" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 122.88 122.88"><defs><style>.cls-1{fill-rule:evenodd;}</style></defs><title>add-plus</title><path class="cls-1" d="M61.44,0A61.44,61.44,0,1,1,0,61.44,61.44,61.44,0,0,1,61.44,0ZM93.79,55.21V67.66a4.63,4.63,0,0,1-4.62,4.62H72.28V89.17a4.63,4.63,0,0,1-4.62,4.62H55.21a4.63,4.63,0,0,1-4.61-4.62V72.28H33.7a4.63,4.63,0,0,1-4.61-4.62V55.21A4.63,4.63,0,0,1,33.7,50.6H50.6V33.7a4.63,4.63,0,0,1,4.61-4.61H67.66a4.63,4.63,0,0,1,4.62,4.61V50.6H89.17a4.63,4.63,0,0,1,4.62,4.61Z"/></svg>
      </button>
      <a class="btn btn-flat-browse" href="#" title="Browse">
        <svg version="1.1" width="17px" height="17px" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 122.88 95.21" style="enable-background:new 0 0 122.88 95.21" xml:space="preserve"><g><path d="M2.48,20.74h4.5v-9.86c0-1.37,1.11-2.48,2.48-2.48h4.41V2.48c0-1.37,1.11-2.48,2.48-2.48h40.26c1.37,0,2.48,1.11,2.48,2.48 V8.4h54.3c1.37,0,2.48,1.11,2.48,2.48v9.86h4.53c1.37,0,2.48,1.11,2.48,2.48c0,0.18-0.02,0.36-0.06,0.52l-8.68,63.81 c-0.28,2.08-1.19,4.01-2.59,5.41c-1.38,1.38-3.21,2.24-5.36,2.24H14.7c-2.16,0-4.03-0.87-5.43-2.26c-1.41-1.41-2.31-3.35-2.54-5.46 l-6.72-64c-0.14-1.36,0.85-2.58,2.21-2.72C2.31,20.75,2.39,20.75,2.48,20.74L2.48,20.74L2.48,20.74z M9.46,25.71H5.23l6.43,61.27 c0.1,0.98,0.5,1.85,1.1,2.46c0.5,0.5,1.17,0.81,1.93,0.81h91.5c0.75,0,1.38-0.3,1.87-0.79c0.62-0.62,1.03-1.53,1.17-2.55 l8.32-61.19H9.46L9.46,25.71z M11.94,13.37v7.36l98.97-1.05v-6.31h-54.3c-1.37,0-2.48-1.11-2.48-2.48V4.97h-35.3v5.92 c0,1.37-1.11,2.48-2.48,2.48H11.94L11.94,13.37z"/></g></svg>
      </a>
      <input id="fileInput2" name="fileInput2" class="fileInput" data-staff = "csv-file" title="Choose file to upload" type="file" accept=".csv">
    </div>
    <div class="inputFileMask">
      <input class="inputFileMaskText2" readonly="readonly" placeholder="Upload .csv file.." type="text" id="inputFileMaskText2">
    </div>
  </div>
</div> <hr />


      <table id="example" class="table table-hover responsive nowrap" style="width:100%">
      <thead>
          <tr>
            <th>Staff Name</th>
            <th>Staff category</th>
            <th>Staff Department</th>
            <th>Staff Position</th>
            <th>Staff other position</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
  <?php Clients::getAllStaffs();
    foreach(Clients::$allStaffs as $staff){?>
          <tr>
            <td>
              <a href="/staff/<?php echo $staff['id'] ;?>?etr3545-3656-32dsdf-32dsd-fdhg-323-sads-23-sddfds-a">
                <div class="d-flex align-items-center">
                  <div class="avatar avatar-blue mr-3"></div>

                  <div class="">
                    <p class="font-weight-bold mb-0"><?php echo $staff['sfName'] ;?></p>
                    <p class="text-muted mb-0"><?php echo $staff['sfCategory'] ;?></p>
                  </div>
                </div>
              </a>
            </td>
            <td><?php echo $staff['sfGender'] ;?></td>
            <td><?php echo $staff['sfDepartment'] ;?></td>
            <td><?php echo $staff['sfPosition'] ;?></td>
            <td><?php echo $staff['sfOtherPosition'] ? $staff['sfOtherPosition'] : '-' ;?></td>
            <td>
              <div class="dropdown">
                <button class="btn btn-sm btn-icon" type="button" id="dropdownMenuButton2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="10px" height="20.88px" viewBox="0 0 29.957 122.88" enable-background="new 0 0 29.957 122.88" xml:space="preserve"><g><path fill-rule="evenodd" clip-rule="evenodd" d="M14.978,0c8.27,0,14.979,6.708,14.979,14.979c0,8.27-6.709,14.976-14.979,14.976 C6.708,29.954,0,23.249,0,14.979C0,6.708,6.708,0,14.978,0L14.978,0z M14.978,92.926c8.27,0,14.979,6.708,14.979,14.979 s-6.709,14.976-14.979,14.976C6.708,122.88,0,116.175,0,107.904S6.708,92.926,14.978,92.926L14.978,92.926z M14.978,46.463 c8.27,0,14.979,6.708,14.979,14.979s-6.709,14.978-14.979,14.978C6.708,76.419,0,69.712,0,61.441S6.708,46.463,14.978,46.463 L14.978,46.463z"></path></g></svg>
                </button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton2">
                  <a class="dropdown-item" href="/staff/<?php echo $staff['id'] ;?>?etr3545-3656-32dsdf-32dsd-fdhg-323-sads-23-sddfds-a"><svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" width="10px" height="20.88px" viewBox="0 0 122.88 121.51"><title>edit</title><path d="M28.66,1.64H58.88L44.46,16.71H28.66a13.52,13.52,0,0,0-9.59,4l0,0a13.52,13.52,0,0,0-4,9.59v76.14H91.21a13.5,13.5,0,0,0,9.59-4l0,0a13.5,13.5,0,0,0,4-9.59V77.3l15.07-15.74V92.85a28.6,28.6,0,0,1-8.41,20.22l0,.05a28.58,28.58,0,0,1-20.2,8.39H11.5a11.47,11.47,0,0,1-8.1-3.37l0,0A11.52,11.52,0,0,1,0,110V30.3A28.58,28.58,0,0,1,8.41,10.09L8.46,10a28.58,28.58,0,0,1,20.2-8.4ZM73,76.47l-29.42,6,4.25-31.31L73,76.47ZM57.13,41.68,96.3.91A2.74,2.74,0,0,1,99.69.38l22.48,21.76a2.39,2.39,0,0,1-.19,3.57L82.28,67,57.13,41.68Z"/></svg> Edit Profile</a>
                  <a class="dropdown-item " href="/counsel/<?php echo $staff['id']; ?>?etr3545-3656-32dsdf-32dsd-fdhg-323-sads-23-sddfds-a=staff""> Counsel</a>
                </div>
              </div>
            </td>
          </tr>

          <?php } ?>
        </tbody>
      </table>
    </div>
  </div>
</div>
<script src="/views/assets/dataTables/jquery.js"></script>
<script src="/views/assets/dataTables/popper.js"></script>
<script src="/views/assets/dataTables/bootstrap.min.js"></script>
<script src="/views/assets/dataTables/jquery.dataTables.min.js"></script>
<script src="/views/assets/dataTables/dataTables.responsive.min.js"></script>
<script src="/views/assets/dataTables/dataTables.bootstrap4.min.js"></script>
<script src="/views/assets/js/datatable.js"></script>
<script src="/views/assets/js/alert.js"></script>
<script>
  $('#fileInput').on('change', function(){
  var control = $('#inputFileMaskText');
  control.val(this.files[0].name);
});

$('#fileInput2').on('change', function(){
  var control = $('#inputFileMaskText2');
  control.val(this.files[0].name);
});


const file = document.querySelector('[data-staff = "csv-file"]'),
      errorDiv = document.querySelector('[data-student = "error"]');

const errorMsg = (message) => {
  errorDiv.innerText = message;
  setTimeout(() => {
    errorDiv.style.display = 'block';
  
  }, 10);
}

const uploadCsv = () => {
  let form = new FormData();
  form.append('csvFile', file.files[0]);
  form.append('addCsv', true);
  fetch('/csvAddStaff', {
    method : 'POST',
    body : form
  })
  .then(response => response.json())
  .then((result) => {
    if(result.status){
        window.scrollTo({
            top: 0,
            behavior: 'smooth'
          })
        customAlert.alert(result.message);
        setTimeout(() => {
            location.href = '/staffs';
        }, 2500);
    }else{
        errorMsg(result.message);
        setTimeout(() => {
            errorDiv.style.display = 'none';
            errorDiv.innerText = '';
        }, 5000);
    }

  })
  .catch(err=>alert(err));
}
</script>
</body>
</html>